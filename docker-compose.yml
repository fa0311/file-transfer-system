version: '3.8'

services:
  server-a:
    image: ghcr.io/fa0311/file-transfer-system/file-transfer-server:latest
    container_name: file-transfer-server-a
    environment:
      - PEER_SERVER_ADDR=server-b:50051
      - ROOT_DIR=/data
      - HTTP_PORT=8080
      - GRPC_PORT=50051
    ports:
      - "8080:8080"
      - "50051:50051"
    volumes:
      - ./data/server-a:/data
    restart: unless-stopped
    networks:
      - file-transfer-net

  server-b:
    image: ghcr.io/fa0311/file-transfer-system/file-transfer-server:latest
    container_name: file-transfer-server-b
    environment:
      - PEER_SERVER_ADDR=server-a:50051
      - ROOT_DIR=/data
      - HTTP_PORT=8081
      - GRPC_PORT=50052
    ports:
      - "8081:8081"
      - "50052:50052"
    volumes:
      - ./data/server-b:/data
    restart: unless-stopped
    networks:
      - file-transfer-net

networks:
  file-transfer-net:
